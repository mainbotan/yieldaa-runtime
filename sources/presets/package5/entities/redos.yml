module: crm
object: client
property: requisite
code: individual1
name: ИП
fields:
  # 1. Классический exponential backtracking
  - code: inn
    name: ИНН
    type: string
    pattern: "^([0-9]{1,2})?([0-9]{1,2})?([0-9]{1,2})?([0-9]{1,2})?([0-9]{1,2})?([0-9]{1,2})?([0-9]{1,2})?([0-9]{1,2})?([0-9]{1,2})?([0-9]{1,2})?([0-9]{1,2})?([0-9]{1,2})?$"
    # Выглядит как "от 1 до 12 цифр", но на "a"*100 будет O(2^n)
    required: true

  # 2. Catastrophic backtracking с nested quantifiers
  - code: ogrnip
    name: ОГРНИП
    type: string
    pattern: "^(3[0-9]{0,100}){1,100}$"
    # Экспоненциальный взрыв на строке "3" + "a"*100
    required: true

  # 3. Evil regex с overlapping alternations
  - code: registration_date
    name: Дата регистрации
    type: string
    pattern: "^(\\d{4})?(-)?(\\d{2})?(-)?(\\d{2})?$|^(\\d{4})-?(\\d{2})-?(\\d{2})$|^(\\d{4})-(\\d{2})-(\\d{2})$"
    # Множественные пересекающиеся варианты
    required: true

  # 4. Polynomial blowup с вложенными группами
  - code: full_name
    name: ФИО предпринимателя
    type: string
    pattern: "^([А-ЯЁ][а-яё]+(?: )?){1,10}([А-ЯЁ][а-яё]+(?: )?){1,10}([А-ЯЁ][а-яё]+(?: )?){1,10}$"
    # O(n^3) на длинных строках
    required: true
    min: 5
    max: 1000  # Увеличим лимит для большего урона

  # 5. Evil regex для кода ОКВЭД
  - code: okved
    name: Код ОКВЭД
    type: string
    pattern: "^([0-9]{2})(\\.([0-9]{2})(\\.([0-9]{1,2})?)?)?$"
    # Экспоненциальный backtracking на "12.34.56.78.90"
    required: false

  # 6. Polynomial ReDoS на email-like поле (если добавить)
  - code: contact_email
    name: Контактный email
    type: string
    pattern: "^([a-zA-Z0-9]+([._%+-]?[a-zA-Z0-9]+)*)@([a-zA-Z0-9]+([.-]?[a-zA-Z0-9]+)*\\.[a-zA-Z]{2,})$"
    required: false

  # 7. Бесконечный квантификатор
  - code: registration_address
    name: Адрес регистрации
    type: string
    pattern: "^(ул\\.|улица|просп\\.|проспект|пр\\.|бульвар|пер\\.|переулок|ш\\.|шоссе)(.+)*$"
    required: true
    min: 10
    max: 10000